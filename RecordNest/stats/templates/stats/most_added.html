{% extends "main/base.html" %}
{% load static %}

{% block content %}

<link rel="stylesheet" href="{% static 'css/stats.css' %}">
<div class="main-content">
    <h1 class="stats-title">Top 10 Discos m치s a침adidos</h1>

    <div class="most-added-grid">
      {% for record in most_added %}
        <div class="record-card">
          <div class="record-card-inner">
            <div class="image-container">
              <!-- Mostrar la imagen peque침a -->
              <img src="{{ record.image_url|default:'/static/images/placeholder-image.png' }}" alt="{{ record.title }}">
            </div>
            <div class="record-info">
              <h3>{{ record.title }}</h3>
              <p><strong>Artista:</strong> {{ record.artists }}</p>
              <p><strong>Total en colecciones:</strong> {{ record.total_added }}</p>
              <a href="{% url 'record_detail' %}?master_id={{ record.master_id }}" class="cta-button-small">Ver detalle</a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <h2 class="chart-title">Visualizaci칩n de popularidad</h2>
    <canvas id="mostAddedChart" width="600" height="400"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('mostAddedChart').getContext('2d');
const mostAddedChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: [{% for record in most_added %}"{{ record.title|escapejs }}",{% endfor %}],
        datasets: [{
            label: 'Cantidad de colecciones',
            data: [{% for record in most_added %}{{ record.total_added }},{% endfor %}],
            backgroundColor: 'rgba(174, 214, 178, 0.8)',
            borderColor: 'rgba(174, 214, 178, 1)',
            borderWidth: 1,
            borderRadius: 5
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: {
                display: false
            },
            tooltip: {
                backgroundColor: '#252321',
                titleColor: '#aed6b2',
                bodyColor: '#fff'
            }
        },
        scales: {
            y: {
                beginAtZero: true,
                ticks: {
                    color: '#fff'
                },
                grid: {
                    color: '#333'
                }
            },
            x: {
                ticks: {
                    color: '#fff'
                },
                grid: {
                    color: '#333'
                }
            }
        }
    }
});
</script>
{% endblock %}
